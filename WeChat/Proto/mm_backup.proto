// clang-format -i -style=file ./WeChat/proto/mm.proto
// protoc --proto_path /Users/ray/Desktop/WeChat/WeChat/proto/
// --objc_out=/Users/ray/Desktop/WeChat/WeChat/proto/
// /Users/ray/Desktop/WeChat/WeChat/proto/mm.proto

// 10 true
// 11 false
// 10000 int8_t
// 20000 uint8_t
// 30000 int16_t
// 40000 uint16_t
// 50000 intValue
// 60000 uint32_t
// 70000 int64_t
// 80000 uint64_t
// 1000000 float
// 2000000 double
// 3000000 long double

syntax = "proto2";

message SKBuiltinBuffer_t
{
    optional uint32 iLen  = 1;
    optional bytes buffer = 2;
}

message SKBuiltinString_t { optional string string = 1; }

message BaseRequest
{
    optional bytes sessionKey     = 1; //解密服务器返回封包时使用的aeskey
    optional uint32 uin           = 2;
    optional bytes deviceId       = 3; //手机guid长度16,这里取前15字节,以'\0'结尾
    optional uint32 clientVersion = 4;
    optional bytes deviceType     = 5;
    optional uint32 scene         = 6;
}

message BaseResponse
{
    optional int32 ret                = 1; //错误码
    optional SKBuiltinString_t errMsg = 2; //错误信息
}

// QRCode获取
message GetLoginQRCodeRequest
{
    required BaseRequest baseRequest            = 1;
    required SKBuiltinBuffer_t randomEncryKey   = 2; // iPad 16位 iMac 184位
    required int32 opcode                       = 3; // 0
    optional string deviceName                  = 4; // iMac "iMac"
    optional string userName                    = 5;
    optional int32 hardwareExtra                = 6; // iMac 0,
    optional string softType                    = 7;
    optional int32 extDevLoginType              = 8; // 0
    optional SKBuiltinBuffer_t msgContextPubKey = 9; // iMac
}

message GetLoginQRCodeResponse
{
    required BaseResponse baseResponse                   = 1;
    required SKBuiltinBuffer_t qrcode                    = 2;
    required string uuid                                 = 3;
    required int32 checkTime                             = 4;
    optional SKBuiltinBuffer_t notifyKey                 = 5;
    optional int32 expiredTime                           = 6;
    optional string blueToothBroadCastUuid               = 7;
    optional SKBuiltinBuffer_t blueToothBroadCastContent = 8;
}

// QRCode Check
message CheckLoginQRCodeRequest
{
    required BaseRequest baseRequest          = 1;
    required SKBuiltinBuffer_t randomEncryKey = 2;
    required string uuid                      = 3;
    required int32 timeStamp                  = 4;
    required int32 opcode                     = 5;
}

message CheckLoginQRCodeResponse
{
    required BaseResponse baseResponse = 1;

    message LoginQRCodeNotifyPkg
    {
        optional SKBuiltinBuffer_t NotifyData = 1; //是bytes,需notifykey不解压aes解密一次,解密后再序列化成下面的对象
        optional int32 Opcode = 2;
    }
    optional LoginQRCodeNotifyPkg notifyPkg = 3;
}

message NotifyMsg
{
    optional string uuid                   = 1;
    optional int32 state                   = 2;
    optional string wxid                   = 3;
    optional string wxnewpass              = 4;
    optional string avatar                 = 5;
    optional int32 pushLoginUrlExpiredTime = 6;
    optional string nickName               = 7;
    optional int32 effectiveTime           = 8;
    optional int32 t10                     = 10;
    optional string devices                = 11;
}

message ECDHKey
{
    required uint32 nid            = 1; //椭圆曲线类型
    required SKBuiltinBuffer_t key = 2;
}

//登录请求--账号信息
message ManualAuthRsaReqData
{
    required SKBuiltinBuffer_t randomEncryKey =
        1; //仅用于本次登录请求,后续通讯使用的aeskey根据服务器返回的数据做ECDH生成
    optional ECDHKey cliPubEcdhkey = 2;
    optional string userName       = 3;
    optional string pwd            = 4;
    optional string pwd2           = 5;
}

//登录请求--设备信息
message ManualAuthAesReqData
{
    required BaseRequest baseRequest     = 1;
    required BaseAuthReqInfo baseReqInfo = 2;
    required string imei                 = 3;
    required string softType = 4; // iPad: <softtype><k3>11.4.1</k3><k9>iPad</k9></softtype>  ，iMac不需要此字段
    required int32 builtinIpseq     = 5;  // 0
    required string clientSeqId     = 6;  // iPad: dd09ae95fe48164451be954cd1871cb7-1537165222, iMac: ""
    optional string clientSeqIDSign = 7;  // android only
    required string deviceName      = 8;  // iPad:ccc iPad, iMac: ray的iMac
    required string deviceType      = 9;  // iPad iMac18,2 android 不一样
    required string language        = 10; // zh_CN
    required string timeZone        = 11; // 8.00
    required int32 channel          = 13; // iPad:3d  iMac:0
    required int32 timeStamp        = 14; // 1537178341
    optional string deviceBrand     = 15; // Apple
    optional string deviceModel     = 16; // android only
    optional string ostype          = 17; // iMac "Version 10.13.6 (Build 17G65)"
    required string realCountry     = 18; // CN
    optional string bundleId        = 19; // iPad:com.tencent.xin , iMac:com.tencent.xinWeChat **** ios only
    optional string adSource        = 20; // iPad:"AAA7AE28-7620-431D-8B4C-7FB4F67AA45E", iMad: "" **** ios only ****
    optional string iphoneVer       = 21; // iPad:iPad4,4 , iMac:iMac18,2 **** ios only ****
    required int32 inputType        = 22; // 2
    optional SKBuiltinBuffer_t clientCheckData = 23; // **** ios only ****
}

message ManualAuthRequest
{
    required ManualAuthRsaReqData rsaReqData = 1;
    required ManualAuthAesReqData aesReqData = 2;
}

//////////////// 自动登录 请求 Start /////////////////

//自动登录rsa部分
message AutoAuthRsaReqData
{
    optional SKBuiltinBuffer_t aesEncryptKey = 2;
    optional ECDHKey cliPubEcdhkey           = 3;
}

message WTLoginImgReqInfo
{
    optional string imgSid          = 1;
    optional string imgCode         = 2;
    optional string imgEncryptKey   = 3;
    optional SKBuiltinBuffer_t ksid = 4;
}

message WxVerifyCodeReqInfo
{
    optional string verifySignature = 1;
    optional string verifyContent   = 2;
}

message BaseAuthReqInfo
{
    optional SKBuiltinBuffer_t wtloginReqBuff        = 1;
    optional WTLoginImgReqInfo wtloginImgReqInfo     = 2;
    optional WxVerifyCodeReqInfo wxVerifyCodeReqInfo = 3;
    optional SKBuiltinBuffer_t cliDbencryptKey       = 4;
    optional SKBuiltinBuffer_t cliDbencryptInfo      = 5;
    optional uint32 authReqFlag                      = 6;
    optional string authTicket                       = 7;
}

message AutoAuthAesReqData
{
    required BaseRequest baseRequest           = 1;
    optional BaseAuthReqInfo baseReqInfo       = 2;
    optional SKBuiltinBuffer_t autoAuthKey     = 3;
    optional string imei                       = 4;
    optional string softType                   = 5;
    optional uint32 builtinIpseq               = 6;
    optional string clientSeqId                = 7;
    optional string signature                  = 8;
    optional string deviceName                 = 9;
    optional string deviceType                 = 10;
    optional string language                   = 11;
    optional string timeZone                   = 12;
    optional uint32 channel                    = 13;
    optional SKBuiltinBuffer_t clientCheckData = 14;
}

message AutoAuthRequest
{
    optional AutoAuthRsaReqData rsaReqData = 1;
    optional AutoAuthAesReqData aesReqData = 2;
}

//////////////// 自动登录 请求 End /////////////////

//////////////// 登录 响应 Start /////////////////

message NetworkControl
{
    optional string portList        = 1;
    optional string timeoutList     = 2;
    optional int32 minNoopInterval  = 3;
    optional int32 maxNoopInterval  = 4;
    optional int32 typingInterval   = 5;
    optional int32 noopIntervalTime = 7;
}

message BuiltinIPList
{
    optional int32 longConnectIpcount  = 1;
    optional int32 shortConnectIpcount = 2;

    message BuiltinIP
    {
        optional int32 type    = 1;
        optional int32 port    = 2;
        optional string ip     = 3;
        optional string domain = 4;
    }

    repeated BuiltinIP longConnectIplist  = 3;
    repeated BuiltinIP shortConnectIplist = 4;
    optional int32 seq                    = 5;
}

//登录结果
message UnifyAuthResponse
{
    required BaseResponse baseResponse = 1;
    required int32 unifyAuthSectFlag   = 2;

    message AuthSectResp
    {
        required int32 uin             = 1;
        required ECDHKey svrPubEcdhkey = 2;
        required SKBuiltinBuffer_t sessionKey =
            3; //加密的sessionKey 需要使用ECDH握手后的密钥做AES解密得到最终长16字节的aeskey
        optional SKBuiltinBuffer_t autoAuthKey = 4;
        optional int32 wtloginRspBuffFlag      = 5;

        message ShowStyleKey
        {
            optional int32 keyCount = 1;

            message StyleKeyVal
            {
                optional int32 key  = 1;
                optional string val = 2;
            }
        }

        optional ShowStyleKey showStyle = 15;
        optional bytes SmsTicket = 16; //需要短信授权时的ticket,用于后续请求验证码以及发送验证码
        optional int32 authResultFlag = 19;
        optional string fsurl         = 20;
        optional int32 serverTime     = 22;
    }

    required AuthSectResp authSectResp = 3;

    message AcctSectResp
    {
        optional string userName         = 1;
        optional string nickName         = 2;
        optional int32 bindUin           = 3;
        optional string bindMail         = 4;
        optional string bindMobile       = 5;
        optional string alias            = 6;
        optional string bindEmail        = 7;
        optional int32 status            = 8;
        optional int32 pluginFlag        = 9;
        optional int32 regType           = 10;
        optional string deviceInfoXml    = 11;
        optional int32 safeDevice        = 12;
        optional string officialUserName = 13; //"weixin"
        optional string officialNickName = 14; //"微信团队"
        optional int32 pushMailStatus    = 15;
        optional string fsUrl            = 16;
    }
    optional AcctSectResp acctSectResp = 4; //登录成功后返回账号信息

    message NetworkSectResp
    {
        message HostList
        {
            optional int32 count = 1; // host cnt
            message        Host
            {
                optional string origin     = 1; // host
                optional string substitute = 2; // redirect_host
                optional int32 priority    = 3;
            }
            repeated Host list = 2;
        }

        optional HostList newHostList          = 1; //域名重定向信息
        optional NetworkControl networkControl = 2;
        optional BuiltinIPList builtinIplist   = 3;
    }
    optional NetworkSectResp networkSectResp = 5; // dns信息
}

//////////////// 登录 响应 End /////////////////

//新设备第一次登录初始化请求
message NewInitRequest
{
    required BaseRequest baseRequest = 1;
    required string userName         = 2;
    required bytes currentSynckey    = 3; //首次初始化时sync_key_cur = ''
    required bytes maxSynckey        = 4; //首次初始化时sync_key_max = ''
    required string language         = 5;
}

//服务器返回消息(newinit/newsync)
message AddMsg
{
    optional uint32 msgId                   = 1;
    optional SKBuiltinString_t fromUserName = 2; //发送方wxid
    optional SKBuiltinString_t toUserName   = 3; //接收方wxid
    optional int32 msgType =
        4; //消息类型:9999==>系统垃圾消息,10002==>sysmsg(系统垃圾消息),49==>appmsg,1==>文字消息,10000==>系统提示
    optional SKBuiltinString_t content = 5; //原始消息内容,需要根据不同消息类型解析
    optional int32 status              = 6;
    optional int32 imgStatus           = 7;
    optional SKBuiltinBuffer_t imgBuf  = 8;
    optional int32 createTime          = 9;  //消息发送时间
    optional string msgSource          = 10; //消息附加内容(群是否屏蔽,群人数,群at功能)
    optional string pushContent        = 11; //推送内容(xml格式)
    optional int64 newMsgId            = 12; //每条消息的唯一id
    optional int32 msgSeq              = 13; // sync key中的id
}

message SnsUserInfo
{
    optional uint32 snsFlag       = 1;
    optional string snsBgimgId    = 2;
    optional uint64 snsBgobjectId = 3;
    optional uint32 snsFlagEx     = 4;
}

message CustomizedInfoNew {}

message LinkedinContactItem {}

message ChatRoomMemberInfo
{
    optional string userName           = 1;
    optional string nickName           = 2;
    optional string displayName        = 3;
    optional string bigHeadImgUrl      = 4;
    optional string smallHeadImgUrl    = 5;
    optional uint32 chatroomMemberFlag = 6;
    optional string inviterUserName    = 7;
}

message PhoneNumItem { optional string phoneNum = 1; }

message PhoneNumListInfo
{
    optional uint32 count              = 1;
    repeated PhoneNumItem phoneNumList = 2;
}

//好友详细信息
message ModContact
{
    optional SKBuiltinString_t userName     = 1;
    optional SKBuiltinString_t nickName     = 2;
    optional SKBuiltinString_t pyinitial    = 3;
    optional SKBuiltinString_t quanPin      = 4;
    optional uint32 sex                     = 5; //性别：0=>未知,1=>男,2=>女
    optional SKBuiltinBuffer_t imgBuf       = 6;
    optional uint32 bitMask                 = 7;
    optional uint32 bitVal                  = 8; //好友状态:
    optional uint32 imgFlag                 = 9;
    optional SKBuiltinString_t remark       = 10; //备注名:为空则显示nickname
    optional SKBuiltinString_t real_shortPy = 11;
    optional SKBuiltinString_t real_quanpin = 12;
    optional uint32 contactType             = 13;
    optional uint32 roomInfoCount           = 14;
    optional string tag16                   = 16;
    optional uint32 chatRoomNotify          = 17;
    optional uint32 addContactScene         = 18;
    optional string province                = 19;
    optional string city                    = 20;
    optional string signature               = 21; //签名
    optional uint32 personalCard            = 22; // todo
    optional int32 tag23                    = 23; // todo
    optional uint32 verifyFlag              = 24; // 8=>个人;24=>公司
    optional string verifyInfo              = 25; //注册主体:xx公司或个人
    optional uint32 level                   = 26;
    optional uint32 source =
        27; //好友来源:(10000XX为对方添加自己)0=>未知;1=>QQ;3=>微信号;6=>名片;13=>手机通讯录;14=>群聊;15=>手机号;30=>扫一扫
            //（1000015=>对方手机号;1000030=>对方扫一扫;1000014=>对方群聊......）
    optional string weibo                     = 28;
    optional string verifyContent             = 29;
    optional string alias                     = 30; //微信号(未设置则显示wxid)
    optional string chatRoomOwner             = 31;
    optional string weiboNickname             = 32;
    optional uint32 weiboFlag                 = 33;
    optional uint32 albumStyle                = 34;
    optional uint32 albumFlag                 = 35;
    optional string albumBgimgId              = 36;
    optional SnsUserInfo snsUserInfo          = 37; //个人相册封面图片
    optional string country                   = 38;
    optional string bigHeadImgUrl             = 39;
    optional string smallHeadImgUrl           = 40;
    optional string myBrandList               = 41;
    optional CustomizedInfoNew customizedInfo = 42;
    optional string chatRoomData              = 43;
    optional string headImgMd5                = 44;
    optional string encryptUserName           = 45;
    optional string realName                  = 47;
    optional string mobileFullHash            = 49;
    optional bytes additionalContactList      = 50;

    optional uint32 chatroomVersion    = 53;
    optional string extInfo            = 54;
    optional uint32 chatroomMaxCount   = 55;
    optional uint32 chatroomAccessType = 56;
    message         GroupMemberList
    {
        optional uint32 memberCount                = 1;
        repeated ChatRoomMemberInfo chatRoomMember = 2;
        optional uint32 infoMask                   = 3;
        optional string tag4                       = 4;
    }

    optional GroupMemberList newChatroomData   = 57;
    optional uint32 deleteFlag                 = 58;
    optional string description                = 59;
    optional string cardImgUrl                 = 60;
    optional string labelIdlist                = 61;
    optional PhoneNumListInfo phoneNumListInfo = 62;
    optional string weiDianInfo                = 63;
    optional uint32 chatroomInfoVersion        = 64;
    optional uint32 deleteContactScene         = 65;
    optional uint32 chatroomStatus             = 66;
    optional uint32 extFlag                    = 67;
}

//同步消息
message CmdItem
{
    optional int32 cmdId              = 1; //消息类型:1==>个人信息,2==>好友信息,5==>服务器上未读取的最新消息,其余消息类型暂未知
    optional SKBuiltinBuffer_t cmdBuf = 2;
}

//新设备第一次登录初始化服务器响应
message NewInitResponse
{
    optional BaseResponse baseResponse = 1;
    optional bytes currentSynckey      = 2; //当前synckey二进制数据
    optional bytes maxSynckey =
        3; //最新synckey二进制数据(若与sync_key_cur不相同,则continue_flag返回1,表示需要继续初始化)
    optional int32 continueFlag =
        4; //为1时表示仍要继续调用newinit初始化,直到该标志位返回0停止初始化(联系人或未读消息数据太多,无法一次获取完毕)
    optional int32 count  = 6; // tag7结构体数量
    repeated CmdItem list = 7; //需要根据消息类型解析
}

//同步消息
message NewSyncRequest
{
    required string oplog        = 1; // unknown,must be 0
    required int32 selector      = 2; // unknown,just set 7
    required bytes keyBuf        = 3; //同步成功后服务器返回的消息id
    required int32 scene         = 4; // unkown,just set 3
    required string deviceType   = 5; // android-22 iOS11.3.1
    required int32 syncMsgDigest = 6; // unknown,just set 1
}

//同步消息响应
message NewSyncResponse
{
    optional int32 ret = 1;
    message        CmdList
    {
        optional int32 count  = 1; // tag2结构体数量
        repeated CmdItem list = 2; //需要根据消息类型解析
    }
    optional CmdList cmdList     = 2; //未读消息
    optional int32 continueFlag  = 3;
    optional bytes keyBuf        = 4; //服务器返回的sync key
    optional int32 status        = 5;
    optional int32 onlineVersion = 6;
    optional int32 svrTime       = 7;
}

message MicroMsgRequestNew
{
    optional SKBuiltinString_t toUserName = 1; // to wxid
    optional string content               = 2; //消息内容
    optional int32 type                   = 3; //消息类型: 文字消息=>1,名片=>42，
    optional int32 createTime             = 4; // 1537268848
    optional int64 clientMsgId = 5; //不同消息的utc与client_id必须至少有1个不相同 4287068409, iMac 从1开始？
    optional string msgSource = 6; //群聊at功能 iMac: "<msgsource></msgsource>"
}

//发送消息请求
message SendMsgRequestNew
{
    optional int32 count             = 1; //本次发送的消息数量
    repeated MicroMsgRequestNew list = 2; //这里可以是repeated,允许一次发送多条消息
}

message MicroMsgResponseNew
{
    optional int32 ret =
        1; //错误码  0=>发送成功,-44=>对方开启了朋友验证(被删好友),-22=>消息已发出,但被对方拒收了(被拉黑)
    optional SKBuiltinString_t toUserName = 2; // to wxid
    optional int32 msgId                  = 3;
    optional int32 clientMsgId            = 4;
    optional int32 createTime             = 5;
    optional int32 serverTime             = 6;
    optional int32 type                   = 7; //消息类型
    optional int64 newMsgId               = 8; //消息唯一id
}

//发送消息响应
message SendMsgResponseNew
{
    optional BaseResponse baseResponse = 1;
    optional int32 count               = 2;
    repeated MicroMsgResponseNew list  = 3; //发送结
}

//朋友圈 Start
message SnsTimeLineRequest
{
    optional BaseRequest baseRequest   = 1;
    optional string firstPageMd5       = 2;
    required int32 minFilterId         = 3;
    required int32 maxId               = 4;
    required int32 lastRequestTime     = 5;
    optional int64 clientLatestId      = 6;
    optional SKBuiltinBuffer_t session = 7;
    required int32 networkType         = 8;
    optional string adexpinfo          = 10; //""
}

message PreDownloadInfo
{
    optional uint32 preDownloadPercent = 1;
    optional uint32 preDownloadNetType = 2;
    optional string noPreDownloadRange = 3;
}

message SnsObject
{
    required uint64 id                    = 1; // 12944632620798980176
    required string username              = 2; // wxid_19py48yw39qw22
    required string nickname              = 3; // xiaohao
    required uint32 createTime            = 4; // 1543120458
    required SKBuiltinBuffer_t objectDesc = 5;
    required uint32 likeFlag              = 6;
    required uint32 likeCount             = 7;
    required uint32 likeUserListCount     = 8;
    //    repeated likeUserList = 9;
    required uint32 commentCount         = 10;
    required uint32 commentUserListCount = 11;
    //    repeated commentUserList = 12;
    required uint32 withUserCount     = 13;
    required uint32 withUserListCount = 14;
    //    repeated withUserList = 15;
    required uint32 extFlag    = 16;
    required uint32 noChange   = 17;
    required uint32 groupCount = 18;
    //    repeated groupList = 19;
    required uint32 isNotRichText  = 20;
    optional string referUsername  = 21;
    required uint32 referId        = 22;
    required uint32 blackListCount = 23;
    //    repeated blackList = 24;
    required uint32 deleteFlag     = 25;
    required uint32 groupUserCount = 26;
    //    required groupUser = 27;
    optional SKBuiltinBuffer_t objectOperations = 28;
    optional SnsRedEnvelops snsRedEnvelops      = 29;
    optional PreDownloadInfo preDownloadInfo    = 30;
    optional SnsWeAppInfo weAppInfo             = 31;
}

message SnsTimeLineResponse
{
    required BaseResponse baseResponse   = 1;
    required string firstPageMd5         = 2;
    required int32 objectCount           = 3;
    repeated SnsObject objectList        = 4;
    optional int32 newRequestTime        = 5;
    optional int32 objectCountForSameMd5 = 6;
    optional int32 controlFlag           = 7;
    message        SnsServerConfig
    {
        required int32 postMentionLimit      = 1;
        required int32 copyAndPasteWordLimit = 2;
    }
    optional SnsServerConfig serverConfig = 8;
    required int32 recCount               = 9;
    // repeated recList                      = 10;
    optional bytes session = 11;
}

// ======== 发朋友圈 ========

message TwitterInfo
{
    optional string oauthToken       = 1;
    optional string oauthTokenSecret = 2;
}

message SnsPostCtocUploadInfo
{
    optional uint32 flag       = 1;
    optional uint32 photoCount = 2;
}

message SnsPostOperationFields
{
    optional string shareUrlOriginal = 1;
    optional string shareUrlOpen     = 2;
    optional string jsAppId          = 3;
    optional uint32 contactTagCount  = 4;
    optional uint32 tempUserCount    = 5;
}

message SnsRedEnvelops
{
    optional uint32 rewardCount = 1;
    optional uint32 resourceId  = 2;
    optional uint32 reportId    = 4;
    optional uint32 reportKey   = 5;
}

message CanvasInfo { optional string dataBuffer = 1; }

message SnsWeAppInfo
{
    optional string mapPoiId    = 1;
    optional uint32 appId       = 2;
    optional string userName    = 3;
    optional string redirectUrl = 4;
    optional uint32 showType    = 5;
    optional uint32 score       = 6;
}

message MediaInfo
{
    optional uint32 source          = 1;
    optional uint32 mediaType       = 2;
    optional uint32 videoPlayLength = 3;
    optional string sessionId       = 4;
    optional uint32 startTime       = 5;
}

message SnsPostRequest
{
    required BaseRequest baseRequest        = 1;
    optional SKBuiltinBuffer_t objectDesc   = 2;
    optional uint32 withUserListCount       = 3;
    repeated SKBuiltinString_t withUserList = 4;
    optional uint32 privacy                 = 5;
    optional uint32 syncFlag                = 6;
    optional string clientId                = 7;
    optional uint32 postBgimgType           = 8;
    optional uint32 groupCount              = 9;
    //    repeated SKBuiltinString_t groupUser                   = 10; //分享给谁
    optional uint32 objectSource                           = 11;
    optional uint32 referId                                = 12;
    optional uint32 blackListCount                         = 13;
    repeated SKBuiltinString_t blackList                   = 14; //不让谁看
    optional TwitterInfo twitterInfo                       = 15;
    optional uint32 groupUserCount                         = 16;
    repeated SKBuiltinString_t groupUser                   = 17; //分享给谁看
    optional SnsPostCtocUploadInfo ctocUploadInfo          = 18;
    optional SnsPostOperationFields snsPostOperationFields = 19;
    optional SnsRedEnvelops snsRedEnvelops                 = 20;
    optional SKBuiltinBuffer_t poiInfo                     = 21;
    optional string fromScene                              = 22;
    optional CanvasInfo canvasInfo                         = 23;
    optional uint32 mediaInfoCount                         = 24;
    repeated MediaInfo mediaInfo                           = 25;
    optional SnsWeAppInfo weAppInfo                        = 26;
    optional SKBuiltinBuffer_t clientCheckData             = 27;
}

message SnsPostResponse
{
    required BaseResponse baseResponse = 1;
    optional SnsObject snsObject       = 2;
    optional string spamTips           = 3;
}

//朋友圈 End

message BindOpMobileRequest
{
    required BaseRequest baseRequest          = 1;
    optional string userName                  = 2;
    optional string mobile                    = 3;
    optional int32 opcode                     = 4;
    optional string verifycode                = 5;
    optional int32 dialFlag                   = 6;
    optional string dialLang                  = 7;
    optional string authTicket                = 8;
    optional int32 forceReg                   = 9;
    optional string safeDeviceName            = 10;
    optional string safeDeviceType            = 11;
    optional SKBuiltinBuffer_t randomEncryKey = 12;
    optional string language                  = 13;
    optional int32 inputMobileRetrys          = 14; // ios=0
    optional int32 adjustRet                  = 15; // ios=0
    optional string clientSeqId               = 16; // ios="8fd2fc510d3fb9bb8e0661b0c6a026cc-1545918644"
    optional int32 mobileCheckType            = 17;
    optional string regSessionId              = 18;
    optional SKBuiltinBuffer_t spamBuffer     = 19;
    optional SKBuiltinBuffer_t extSpamInfo    = 20;
}

message BindOpMobileResponse
{
    required BaseResponse baseResponse   = 1;
    optional string ticket               = 2;
    optional string smsNo                = 3;
    optional int32 needSetPwd            = 4;
    optional string pwd                  = 5;
    optional string username             = 6;
    optional BuiltinIPList builtinIplist = 8;

    message NewHostList { optional int32 count = 1; }

    optional NewHostList newHostList       = 7;
    optional NetworkControl networkControl = 9;
    optional string authTicket             = 10;
    optional int32 safeDevice              = 11;
    optional string cc                     = 12;
    optional int32 obsoleteItem1           = 13;

    message SafeDeviceList { optional int32 count = 1; }

    optional SafeDeviceList safeDeviceList = 14;
    optional string pureMobile             = 15;
    optional string formatedMobile         = 16;

    message ShowStyle { optional int32 keyCount = 1; }

    optional ShowStyle showStyle       = 17;
    optional int32 mmtlsControlBitFlag = 18;
    optional string smsUpCode          = 19;
    optional string smsUpMobile        = 20;
    optional int32 mobileCheckType     = 21;
    optional string regSessionId       = 22;
}

//

message GetProfileRequest
{
    required BaseRequest baseRequest = 1;
    required string userName         = 2;
}

message DisturbSetting {}

message ModUserInfo
{
    optional uint32 bitFlag             = 1;
    optional SKBuiltinString_t userName = 2;
    optional SKBuiltinString_t nickName = 3;
    optional uint32 bindUin             = 4;

    optional SKBuiltinString_t bindMobile  = 6;
    optional uint32 status                 = 7;
    optional uint32 imgLen                 = 8;
    optional bytes imgBuf                  = 9;
    optional uint32 sex                    = 10;
    optional string province               = 11;
    optional string city                   = 12;
    optional string signature              = 13;
    optional uint32 personalCard           = 14;
    optional DisturbSetting disturbSetting = 15;
    optional uint32 pluginFlag             = 16;
    optional uint32 verifyFlag             = 17;
    optional string verifyInfo             = 18;
}

message UserInfoExt
{
    optional string bigHeadImgUrl   = 9;
    optional string smallHeadImgUrl = 10;
}

message GetProfileResponse
{
    required BaseResponse baseResponse = 1;
    optional ModUserInfo userInfo      = 2;
    optional UserInfoExt userInfoExt   = 3;
}

//

message KeyVal
{
    optional uint32 key = 1;
    optional uint32 val = 2;
}

message SyncKey
{
    optional uint32 keyCount = 1;
    repeated KeyVal key      = 2;
}

// geta8key
message GetA8KeyReq
{
    optional BaseRequest BaseRequest = 1;
    required uint32 OpCode = 2;
    optional SKBuiltinBuffer_t A2Key = 3;
    optional SKBuiltinString_t AppID = 4;
    optional SKBuiltinString_t Scope = 5;
    optional SKBuiltinString_t State = 6;
    optional SKBuiltinString_t ReqUrl = 7;
    optional string FriendUserName = 8;
    optional uint32 FriendQQ = 9;
    optional uint32 Scene = 10;
    optional string UserName = 11;
    optional string BundleID = 12;
    optional SKBuiltinBuffer_t A2KeyNew = 13;
    optional uint32 Reason = 14;
    optional uint32 FontScale = 15;
    optional uint32 Flag = 16;
    optional string NetType = 17;
    optional uint32 codeType = 18;
    optional uint32 codeVersion = 19;
    optional uint32 requestId = 20;
    optional string functionId = 21;
    optional uint32 walletRegion = 22;
    optional SKBuiltinBuffer_t cookie = 23;
    optional string outerUrl = 24;
    optional uint32 subScene = 25;
}

message JSAPIPermissionBitSet
{
    required uint32 BitValue = 1;
    optional uint32 BitValue2 = 2;
    optional uint32 BitValue3 = 3;
    optional uint32 BitValue4 = 4;
}

message GeneralControlBitSet {
    required uint32 BitValue = 1;
}

message BizApiInfo {
    optional string ApiName = 1;
}

message BizScopeInfo {
    optional string Scope = 1;
    required uint32 ScopeStatus = 2;
    optional string ScopeDesc = 3;
    required uint32 ApiCount = 4;
    repeated BizApiInfo ApiList = 5;
}

message DeepLinkBitSet {
    required uint64 BitValue = 1;
}

message HttpHeader
{
    required string key = 1;
    optional string value = 2;
}

message GetA8KeyResp
{
    required BaseResponse BaseResponse = 1;
    optional string FullURL = 2;
    optional string A8Key = 3;
    optional uint32 ActionCode = 4;
    optional string Title = 5;
    optional string Content = 6;
    optional JSAPIPermissionBitSet JSAPIPermission = 7;
    optional GeneralControlBitSet GeneralControlBitSet = 8;
    optional string UserName = 9;
    optional string ShareURL = 15;
    optional uint32 ScopeCount = 16;
    repeated BizScopeInfo ScopeList = 17;
    optional string AntispamTicket = 18;
    optional string SSID = 20;
    optional string MID = 21;
    optional DeepLinkBitSet DeepLinkBitSet = 22;
    optional SKBuiltinBuffer_t JSAPIControlBytes = 23;
    optional uint32 httpHeaderCount = 24;
    repeated HttpHeader httpHeader = 25;
    optional string wording = 26;
    optional string headImg = 27;
    optional SKBuiltinBuffer_t cookie = 28;
    optional string menuWording = 29;
}

// end geta8key

//newreportkvcommrsa (997) = newreportidkeyrsa (987)

message HeavyUserReqInfo {
    optional uint32 monitorIdMapVersion = 1;
}

message KVCommReportItem {
    optional uint32 logId = 1;
    optional bytes value = 2;
    optional uint32 startTime = 3;
    optional uint32 endTime = 4;
    optional uint32 count = 5;
    optional uint32 refreshTime = 6;
    optional uint32 type = 7;

}

message CliReportKVDataPackage {
    optional uint32 uin = 1;
    optional uint32 clientVersion = 2;
    optional uint32 netType = 3;
    repeated KVCommReportItem itemList = 4;
    optional string deviceModel = 5;
    optional string deviceBrand = 6;
    optional string osName = 7;
    optional string osVersion = 8;
    optional string languageVer = 9;
    optional uint32 datatype = 10;
}

//CliReportKVReq
message CliReportKVReq {
    optional uint32 generalVersion = 1;
    optional uint32 specialVersion = 2;
    optional uint32 whiteOrBlackUinVersion = 3;
    repeated CliReportKVDataPackage dataPkg = 4;
    optional bytes randomEncryKey = 5;
    optional HeavyUserReqInfo heavyUserInfo = 6;

}

//CliReportKVResp

message HeavyUserRespInfo {
    optional uint32 monitorIdMapVersion = 1;
    repeated StrategyInterval monitorIdMapStrategys = 2;
    optional uint32 respType = 3;
}

message NewStrategyItem {
    optional uint32 logId = 1;
    optional uint32 reportCycle = 2;
    optional uint32 reportFlag = 3;
    optional uint32 sampleRatio = 4;
    optional uint32 sampleMode = 5;
    optional uint32 sampleValidInterval = 6;
    optional uint32 monitorFlag = 7;
    optional uint32 type = 8;
}

message StrategyInterval {
    optional uint32 logIdbegin = 1;
    optional uint32 logIdend = 2;
    repeated NewStrategyItem strategyItem = 3;
}

message CliReportKVResp {
    optional uint32 ret = 1;
    optional uint32 generalVersion = 2;
    optional uint32 specialVersion = 3;
    optional uint32 whiteOrBlackUinVersion = 4;
    repeated StrategyInterval generalStrategies = 5;
    optional uint32 maxValidDataTime = 8;
    optional uint32 banReportTime = 9;
    optional uint32 askSvrStrategyInterval = 10;
    optional HeavyUserRespInfo heavyUserInfo = 11;
}

message GetCliKVStrategyReq {
    optional uint32 generalVersion = 1;
    optional uint32 specialVersion = 2;
    optional uint32 whiteOrBlackUinVersion = 3;
    repeated bytes randomEncryKey = 4;
    optional uint32 kvgeneralVersion = 5;
    optional uint32 kvspecialVersion = 6;
    optional uint32 kvwhiteOrBlackUinVersion = 7;
    optional HeavyUserRespInfo heavyUserInfo = 8;
}

message GetCliKVStrategyResp {
    optional uint32 ret = 1;
    optional uint32 generalVersion = 2;
    optional uint32 specialVersion = 3;
    optional uint32 whiteOrBlackUinVersion = 4;
    repeated StrategyInterval kvspecialStrategies = 5;

    optional uint32 maxValidDataTime = 8;
    optional uint32 banReportTime = 9;
    optional uint32 askSvrStrategyInterval = 10;
    optional uint32 kvgeneralVersion = 11;
    optional uint32 kvspecialVersion = 12;
    optional uint32 kvwhiteOrBlackUinVersion = 13;
    repeated StrategyInterval kvgeneralStrategies = 14;
    optional HeavyUserRespInfo heavyUserInfo = 17;
    optional uint32 aaa = 19;
}

// encryptchecktinkerupdate(180)
// encryptcheckresupdate(722) CheckResUpdateRequest CheckResUpdateResponse

message SubTypeVector
{
    optional int32 subType              = 1;
    optional int32 keyVersion           = 2;
    optional int32 resVersion           = 3;
    optional int32 eid                  = 4;
}

message ResID
{
    optional int32 type                     = 1;
    repeated SubTypeVector subTypeVector    = 2;
}

message ResIDWrap {
    repeated ResID resId                        = 1;
}

message CheckResUpdateRequest {
    required BaseRequest baseRequest            = 1;
    optional ResIDWrap wrap = 2;
}

message CheckResUpdateResponse {
    required BaseResponse baseResponse = 1;
}

message EncryptKey {
     optional SKBuiltinBuffer_t key = 1;
}

// sec
message SecEncryptCheckResUpdateRequest {
    optional EncryptKey aesEncryptKey = 1;
    optional CheckResUpdateRequest req = 2;
}

message Resource {
    optional uint32 subType = 1;
    message ResourceMeta {
        optional string md5 = 1;
        optional uint32 resVersion = 2;
        optional string url = 3;
        optional uint32 fileFlag = 4;
//        eccmd5SignatureList = 5;
        optional bytes data = 6;
        optional string originalMd5 = 7;
        optional uint32 fileSize = 8;
    }
    optional ResourceMeta info = 2;
    
    message ResourceKey {
        optional uint32 keyVersion = 1;
        optional string resKey = 2;
    }
    
    optional ResourceKey key = 3;
    optional uint32 oper = 4;
    optional uint32 reportId = 5;
    optional string sampleId = 6;
    optional uint32 expireTime = 7;
    optional uint32 retryTime = 8;
    optional uint32 eid = 9;
    optional uint32 downloadNetType = 10;
    optional uint32 retryInterval = 11;
    optional uint32 priority = 12;
}

message ResourceType
{
    required uint32 type = 1;
    repeated Resource resources = 2;
}

message SecEncryptCheckResUpdateResponse {
    required BaseResponse baseResponse = 1;
    repeated ResourceType resourceType = 2;
}

message RealTimeKVReportReq {
    required BaseRequest baseRequest = 1;
    optional string deviceModel = 2;
    optional string deviceBrand = 3;
    optional string osName = 4;
    optional string osVersion = 5;
    optional string languageVer = 6;
    optional uint32 logId = 7;
    optional string value = 8;
}

message RealTimeKVReportResp {
    required BaseResponse baseResponse = 1;
}

// req resp 126

message Host {
    optional string Origin = 1;
    optional string Substitute = 2;
    optional int32 Priority = 3;
}

message HostList {
    required uint32 Count = 1;
    repeated Host List = 2;
}

message PluginKey {
    optional string Key = 1;
    optional uint32 Id = 2;
}

message PluginKeyList {
    required uint32 Count = 1;
    repeated PluginKey List = 2;
}

message CDNDnsInfo {
    required uint32 Ver = 1;
    required uint32 Uin = 2;
    required uint32 ExpireTime = 3;
    required int32 FrontID = 4;
    required int32 FrontIPCount = 5;
    repeated SKBuiltinString_t FrontIPList = 6;
    optional string ZoneDomain = 7;
    required SKBuiltinBuffer_t AuthKey = 8;
    required int32 ZoneID = 9;
    required int32 ZoneIPCount = 10;
    repeated SKBuiltinString_t ZoneIPList = 11;
    
    optional uint32 frontIpportCount = 14;
    optional uint32 zoneIpportCount = 15;
    optional uint32 fakeUin = 16;
    optional SKBuiltinBuffer_t newAuthKey = 17;
}

message StyleKeyVal {
    required uint32 Key = 1;
    optional string Val = 2;
}

message ShowStyleKey {
    required uint32 KeyCount = 1;
    repeated StyleKeyVal Key = 2;
}

message SecAuthRegKeySect {
    required SKBuiltinBuffer_t AutoAuthKey = 1;
    required ECDHKey SvrPubECDHKey = 2;
    required SKBuiltinBuffer_t SessionKey = 3;
    required uint32 AuthResultFlag = 4;
}

message NewRegRequest {
    required BaseRequest BaseRequest = 1;
    optional string UserName = 2;
    optional string Pwd = 3;
    optional string NickName = 4;
    optional uint32 BindUin = 5;
    optional string BindEmail = 6;
    optional string BindMobile = 7;
    optional string Ticket = 8;
    optional uint32 BuiltinIPSeq = 12;
    optional uint32 DLSrc = 13;
    optional uint32 RegMode = 14;
    optional string TimeZone = 15;
    optional string Language = 16;
    optional uint32 ForceReg = 17;
    optional string RealCountry = 18;
    optional SKBuiltinBuffer_t RandomEncryKey = 19;
    optional string Alias = 20;
    optional string VerifySignature = 21;
    optional string VerifyContent = 22;
    optional uint32 HasHeadImg = 23;
    optional uint32 SuggestRet = 24;
    optional string ClientSeqID = 31;
    optional string AdSource = 32;
    optional string AndroidID = 33;
    optional string MacAddr = 34;
    optional string AndroidInstallRef = 35;
    optional string ClientFingerprint = 36;
    optional ECDHKey CliPubECDHKey = 37;
    optional string GoogleAid = 38;
    optional string BundleID = 39;
    
    optional string bioSigTicket = 41;
    optional uint32 bioSigCheckType = 42;
    optional string clientCheckData = 43;
    optional uint32 mobileCheckType = 44;
    optional string regSessionId = 45;
    optional string privacyPolicyCountry = 46;
}

message NewRegResponse {
    required BaseResponse BaseResponse = 1;
    required uint32 Uin = 2;
    optional string SessionKey = 3;
    optional string OfficialUserName = 4;
    optional string OfficialNickName = 5;
    optional string QQMicroBlogUserName = 6;
    optional string BindEmail = 7;
    required uint32 PushMailStatus = 8;
    optional uint32 SendCardBitFlag = 9;
    optional string PushMailSettingTicket = 10;
    optional BuiltinIPList BuiltinIPList = 14;
    optional string FSURL = 15;
    optional string UserName = 16;
    optional uint32 Status = 17;
    optional NetworkControl NetworkControl = 18;
    optional uint32 ReturnFlag = 19;
    optional uint32 RegType = 20;
    optional string AuthKey = 21;
    optional PluginKeyList PluginKeyList = 22;
    optional string Password = 23;
    optional uint32 ProfileFlag = 24;
    optional HostList NewHostList = 25;
    optional string AutoAuthTicket = 26;
    optional CDNDnsInfo DnsInfo = 27;
    optional string StepTicket = 28;
    optional string VerifySignature = 29;
    optional SKBuiltinBuffer_t VerifyBuff = 30;
    optional ShowStyleKey ShowStyle = 31;
    optional CDNDnsInfo SnsDnsInfo = 32;
    optional CDNDnsInfo AppDnsInfo = 33;
    optional SecAuthRegKeySect SecAuthRegKeySect = 34;
    optional uint32 mmtlsControlBitFlag = 35;
    optional uint32 serverTime = 36;
}
