//
//  ShortLinKWithMMTLSTest.m
//  WXDemo
//
//  Created by ray on 2018/12/5.
//  Copyright Â© 2018 ray. All rights reserved.
//

#import "ShortLinKWithMMTLSTest.h"
#import "ShortLinkWithMMTLS.h"
#import "MMTLSShortLinkResponse.h"

@implementation ShortLinKWithMMTLSTest

+ (void)test
{
    NSData *decryptedPart2 = [NSData dataWithHexString:@"630100093A80000000000023000C9E2AE56305B387C3726D1F4800488FC602890551EE782A1C3A210CB714DEFEE04EFC5BE2D42BC0DCA13EB06FA87B442EF1F2DDE3B01504A0909D54E39F502F2F6C3719E68F80AD86A06DE8386EC2BDB1EA7363F97C90"];
    NSData *resumptionSecret = [NSData dataWithHexString:@"477A9A62A4AA959A10C4E8C6015916A77A059F3FFA628EBA8CECEDA84019E41D"];
    NSData *httpData = [NSData dataWithHexString:@"0000023D002E2F6367692D62696E2F6D6963726F6D73672D62696E2F656E6372797074636865636B74696E6B6572757064617465001373686F72742E77656978696E2E71712E636F6D000001F4BF62701607032100000000B401DC03DC03B201010009000000000016000000DE00000100816F467E57C38275CB7239664D3F436DA6090E4AB8C71D5E01C73BB5A2EAD9F2B8CD124B75EFBCC590658A6C2D2218DBCFD02AD485C6BE91C163E6FEE8BF5C40E134047DD9F33D7A029018E12EB742CDADC756599749FAF22592B23BFFE6F6C8A1BECAB5060273839459F5D417829AD1D340DFF70E198AA63BADEC0BA000F71F4F9B64044236C6CFAA66549A1CDD1ACCCA3A4FA9F0674DF8248F37C7DD2923D8C069786EA2EE30DD110FC2A4047BBB06DECB9EE189A720931987F69BDB15C53CD18DA42096BA9CAC468D8CB222A23FBECCF8168C8669227C9EF963D49DF3352C90136CF3548FBED0A0B06555ACDB81F24A8FB19F6F8B195BACB38B1906BF648E3BB86A675A64639F0F6FE788373041D2DCA3CC7D7A79A01CAA8C161695FB22D3DE70B8124813C69BB08571A17B0AAA7716D2819AD2FD8A981DD5083DC52E7F3D67F9B7814FCBE5C3C312E226A8E3F97FA114D0AF86ABC2D643722D2F065359ABE7066192A3F5B42938AF04A218F1F248256BB7E95952BA81632B38D252EF8344BFEFFF9D4C5A626824037B8CAD3488ACE0907C96233DDED25946A4C652B1B652E8FFC2FDCD700159FA35747C9828292907D64A5266A9F457989633BC1A5A57CE4FA4965438461EF40104D2D20CD71305"];
    ShortLinkWithMMTLS *slm = [[ShortLinkWithMMTLS alloc] initWithDecryptedPart2:decryptedPart2 resumptionSecret:resumptionSecret httpData:httpData];
    NSData *sendData = [slm getSendData];
    
    DLog(@"send data", sendData);
    
    MMTLSShortLinkResponse *response = [[MMTLSShortLinkResponse alloc] initWithData:[NSData dataWithHexString:@"16F103002E0000002A0203F100A8438E9BB86C2C8E61D1FCDE7B09D5198B224664685118B449712F56AB454BB2CE000000010016F1030037461D5158C6C4E367274357F4B7C75139007DD9B7678753C98AD06937BE067CDD2C2F3DE5EAE1121D52403B7CC877315F1B9981504307C017F103010D0F60415A81B6D94A077C30A12B8DC980EA87D07A5DB3B235D42D27A2BE7067D6C3FE9F15E17316282E7184C5A4DFAD3746C7F0CD7CA6F702F29439A71978BA850AA93A18DE33693E75EDAAF0B01AD1D9CCA1EA80A436F08C5CC53DF3F3590C2C59A57781434263315B91F3EAAE602D130B6107D7C24C46BB75DEBD8E8F6DEB717D16D65F6E6FAC5826E4CDE2006B736BE1AE2B8D72A1311DC597AFED829B5F4740CC6BE9FC0028CEA544115D112BFE13C3531494CC224409E92AF20A0A8A8C6C79380BE266BE91AF8899A6A248A62425756A5B61F1D2BD31D3D508B006A577AAD90A2064A986BB717149B0A6A426613E11C9FF619B961D630F729B4AA229A2CB374D4386F13294E47CB0438D5E15F1030017E2363DE581B7ED85020F57414364851FC1969AA5FCBDF8"]];
    
    [slm receiveData:response];
}

@end
